function trace(n){window.opera?opera.postError(n):window.debugService?typeof n=="object"?window.debugService.inspect("trace",n):window.debugService.trace(n):window.console?console.dir&&typeof n=="object"?console.dir(n):console.log(n):alert(n)}!function(n){n.include=function(t,i){function l(t,i,h,c,l){c=u.createElement("script"),e++,c.onload=c.onreadystatechange=function(u,e){e=0,u=this.readyState||u.type,u.search("load|complete")||l||(h?(t=function(){n[h]?o(i):setTimeout(t,r),++e>r&&(t=f)})():o(i),l=r)},c.async=!0,c.src=t,u[s].appendChild(c)}function o(n){n(),!--e&&i()}var u=document,s="body",f=function(){},h={},e=0,r=1;!t.pop&&(t=[t]),i=i||f,!function c(n,o,a,v){if(!u[s])return setTimeout(c,r);o=u.getElementsByTagName("script"),v=f;for(n in o)o[n].src&&(h[o[n].src]=n);for(n=t.length;n--;)t[n].pop?(o=t[n][0],v=t[n][1],a=t[n][2]):o=t[n],h[o]?v():l(o,v,a);!e&&i()}()}}(this),window.Date.prototype.f=function(n){var v,e;n=n+"";var a=["January","February","March","April","May","June","July","August","September","October","November","December"],c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],r=function(n){return(n<0||n>9?"":"0")+n},u=this,s="",h=0,f=u.getYear()+"",o=u.getMonth()+1,w=u.getDate(),l=u.getDay(),i=u.getHours(),y=u.getMinutes(),p=u.getSeconds(),t={};for(f.length<4&&(f=""+(+f+1900)),t.y=""+f,t.yyyy=f,t.yy=f.substr(2,4),t.M=o,t.MM=r(o),t.MMM=a[o-1],t.NNN=a[o-1].substr(0,3),t.N=a[o-1].substr(0,1),t.d=w,t.dd=r(w),t.e=c[l].substr(0,1),t.ee=c[l].substr(0,2),t.E=c[l].substr(0,3),t.EE=c[l],t.H=i,t.HH=r(i),t.h=i==0?12:i>12?i-12:i,t.hh=r(t.h),t.K=i>11?i-12:i,t.k=i+1,t.KK=r(t.K),t.kk=r(t.k),t.a=i>11?"PM":"AM",t.m=y,t.mm=r(y),t.s=p,t.ss=r(p);h<n.length;){for(v=n.charAt(h),e="";n.charAt(h)==v&&h<n.length;)e+=n.charAt(h++);s=t[e]!=null?s+t[e]:s+e}return s},function(n){"use strict";var fi,g,ot;n.efx||(n.efx={}),String.isNullOrEmpty||(String.isNullOrEmpty=function(n){return n?n.toString().replace(/^\s*|\s*$/g,"")==="":!0}),String.format||(fi=new RegExp(/{(\d+)}|{(\d+):([^\r\n{}]+)}/g),String.format=function(n,t){t instanceof Array||(t=Array.prototype.slice.call(arguments,1));for(var u,i,e,r,f=n;(u=fi.exec(n))!=null;)i=t[parseInt(u[1]||u[2],10)],e=u[3]||"",r=pt(i)?"":i.toFormattedString?i.toFormattedString(e):i.format?i.format(e):i.toString(),f=f.split(u[0]).join(r);return f});var i="/rpc.axd",ei={},at={},lt={},ci,yt,ct,gt,ni,t={},bt={},wi=function(){return document.getElementById("tsc_content")},lr=function(n){return bt[n]},pt=function(n){return n===ci?!0:n===null?!0:!1},l=function(n,t){for(t=t.toUpperCase();n&&n.parentNode;)if(n=n.parentNode,n.nodeType===1&&n.nodeName.toUpperCase()===t)return n;return null},ft=function(n,t){return at[t]||(at[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")),at[t].test(n.className)},ut=function(n,t){ft(n,t)||(n.className=((n.className||"")==""?"":n.className+" ")+t)},fr=function(n,t){if(lt[t]||(lt[t]=new RegExp("(^|\\s)"+t)),!String.isNullOrEmpty(t))n.className=n.className.replace(lt[t],"").replace(/^\s+|(\s)\s+/g,"$1")},c=function(n,t){n.style.display=t?"block":"none"},ti=function(n){n.parentNode.removeChild(n)},er=function(n,t){return t?{w:n.offsetWidth,h:n.offsetHeight}:{w:n.clientWidth,h:n.clientHeight}},vt=function(){if(gt&&!ct&&typeof yt!="undefined"&&yt&&ni)ct=!0,efx.showScreen("listQuotesScreen")},d,w,gi=function(t){if(w)throw new Error("Resize event already hooked");w=!0,d=n.onresize,n.onresize=ri(n,function(n){t(),d&&d(n)})},ir=function(){w&&(w=!1,n.onresize=d)},tr="preventDefault stopPropagation type altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),nr=function(n){var t={};return tr.forEach(function(i){t[i]=n[i]}),t.originalEvent=n,t},ui=function(n,t){return function(i){var u,f;i=i||window.event;var r=i.$cloned?i:nr(i),e=i.target,o=i.type;for(r.$cloned=!0,r.currentTarget=n,r.stop=function(){i.stopPropagation(),i.preventDefault()},o.match(/(click|mouse|menu)/i)&&(pt(r.pageX)&&!pt(r.clientX)&&(u=document.documentElement,f=document.body,r.pageX=r.clientX+(u&&u.scrollLeft||f&&f.scrollLeft||0)-(u&&u.clientLeft||f&&f.clientLeft||0),r.pageY=r.clientY+(u&&u.scrollTop||f&&f.scrollTop||0)-(u&&u.clientTop||f&&f.clientTop||0)),o.match(/DOMMouseScroll|mousewheel/)&&(r.wheelDelta=i.wheelDelta?i.wheelDelta/120:-(i.detail||0)/3));e&&e.nodeType==3;)e=e.parentNode;r.target=e,t(r,n)}},yi=function(n,t){var i=ui(n,t);return function(){var t=window.event;t.target=t.srcElement,t.preventDefault=function(){t.returnValue=!1},t.stopPropagation=function(){t.cancelBubble=!0},i(t),t.target=t.relatedTarget=t.preventDefault=t.stopPropagation=t=null}},ri=document.addEventListener?ui:yi,ii=function(n,t){n.onclick=ri(n,t)},o=function(n,t){return n.getAttribute(t)||(n.attributes[t]?n.attributes[t].nodeValue:null)},rr=function(n){var t=n.nodeName.toLowerCase();switch(t){case"textarea":return t;case"select":return String.isNullOrEmpty(o(n,"multiple"))?t:"select-multiple";case"input":return o(n,"type")}return t},s=function(n,t){var u=[],r,s=0,i,o,f=[],c=rr(n),h;o=n.name||"",o!==""&&(f=e(document.getElementsByName(o)));switch(c){case"select":r=n.options[n.selectedIndex],i=r.value||r.text;break;case"select-multiple":for(i=[];(r=n.selectedIndex)!==-1;)(u[u.length]=n.options[r]).selected=!1,i[i.length]=r;return u.forEach(function(n){n.selected=!0}),i;case"checkbox":return i=[],f.forEach(function(n){(n.checked||n.selected)&&(u[u.length]=n,i[i.length]=n.value)}),i;case"radio":for(h=f.length;s<h;++s)if(r=f[s++],r.checked||r.selected){i=r.value;break}break;default:i=n.value}return t?[i]:i},hi=function(n){var t=document.createElement("b");return t.className="loading",t.appendChild(document.createTextNode("Loading...")),n.appendChild(t),t},si=function(n){return{ID:n.ID,ContentType:n.ContentType,Selected:n.Selected,Name:n.Name,LastModificationDate:n.LastModificationDate}},k=function(n){var r,i,t;if(!n)return 0;if(n.Selected)return 2;if(r=n.Children,i=r&&Object.keys(r),!i)return 0;for(t=0;t<i.length;++t)if(k(r[i[t]])!=0)return 1;return 0},ht=function(n){if(!n||!n.ID)return null;var r=n.Children,t=[],i=si(n);return n.Selected?i:k(n)==1&&r?(Object.keys(r).forEach(function(n){var u=r[n],i=ht(u);u&&i&&(t[t.length]=i)}),t.length&&(i.Children=t),i):null},oi=function(n){if(!n||!n.ID)return null;var t,r,i=n.Children,f={},u=si(n);if(i){for(t=0;t<i.length;++t)r=i[t],f[r.ID]=oi(r);t&&(u.Children=f)}return u},b=function(n,t,i){return{ID:n,ContentType:t||"Other",Selected:!1,Name:i||"",Children:{},LastModificationDate:new Date}},bi=function(n,t,f,s){f=f||b(t);var l=hi(n),h="tsc_optionsId_"+t,c=new r(i,function(i){ti(l);var r=document.createElement("ul");r.setAttribute("id",h),ut(r,"tsc_options"),i.forEach(function(n){var o=document.createElement("li"),u=document.createElement("label"),s=document.createElement("span"),i=document.createElement("input"),e=f.Children[n.ID];u.setAttribute("unselectable","on"),i.setAttribute("type","checkbox"),i.setAttribute("name","tsc_options_"+t),i.setAttribute("value",n.ID),i.checked=e&&e.Selected,u.appendChild(i),u.appendChild(s),s.appendChild(document.createTextNode(n.Name)),o.appendChild(u),r.appendChild(o)}),n.appendChild(r)},function(n){u(String.format("Failed to retrieve options. {0}",n),"error")});c.execute("GetChildren",t,s,t),this.getSelected=function(){var t=document.getElementById(h),n;return t?(n=e(t.getElementsByTagName("input")),n&&n.length&&n.forEach(function(n){var t=o(n,"value"),i;n.checked?(i=f.Children[t]||(f.Children[t]=b(t)),i.Selected=!0,i.LastModificationDate=new Date):f.Children[t]=null}),ht(f)):!1}},ki=function(n,t,f,s){f=f||b(t);var nt={},a=function(n,t){var i=g(n.value);i.LastModificationDate=new Date,n.nextSibling&&(n.nextSibling.className="tsc_checkstate"+t);switch(t){case 0:n.removeAttribute("disabled"),i.Selected=n.checked=!1;return;case 1:n.setAttribute("disabled","disabled"),i.Selected=!(n.checked=!0);return;case 2:n.removeAttribute("disabled"),i.Selected=n.checked=!0;return}},h=function(n,t){a(l(n,"li").getElementsByTagName("input")[0],t)},rt=function(n,t){n.stop(),t=document.getElementById(o(t,"for"));var r=g(t.value),i=String.isNullOrEmpty(o(t,"disabled"));i&&a(t,t.checked?0:2),y(t,t.checked),tt(r,t.checked),d(t)},g=function(n){for(var u,t=[],r=f,i;u=nt[n];)t[t.length]=n.split("|")[1],n=u;for(t.reverse(),i=0;i<t.length;++i)r=r.Children[t[i]];return r},tt=function(n,t){n.Selected=t,n.LastModificationDate=new Date;var r=n.Children,i=r&&Object.keys(r);if(i&&i.length)i.forEach(function(n){tt(r[n],t)})},d=function(n){var t=l(n,"ul"),r,i;if(t.length!=0&&(r=v(t),i=0,r.forEach(function(n){n.checked&&++i}),t=l(t,"li"),t!=null)&&(t=t.getElementsByTagName("input"),t.length!==0))n=t[0],i===r.length?h(n,2):i>0?h(n,1):h(n,0),d(n)},y=function(n,t){n.removeAttribute("disabled"),t?h(n,2):h(n,0);var i=it(n);if(i!=null)v(i).forEach(function(n){var i=n.value.split("|")[0];n.checked=t,t?h(n,2):h(n,0),(i==="Mixed"||i==="Folder")&&y(n,t)})},it=function(n){n=l(n,"li").childNodes;for(var i=n.length,t;i>0;)if(t=n[--i],t.nodeName.toUpperCase()==="UL")return t;return null},v=function(n){var t=[];return e(n.children).forEach(function(n){if(n.nodeName.toUpperCase()==="LI")e(n.getElementsByTagName("input")).forEach(function(i){if(i.parentNode==n)t.push(i)})}),t},et=function(n,t){n.stop();var u=t.href.split("|"),i=l(t,"li"),r="open";ft(t,r)?(fr(t,r),w(i,!1)):(ut(t,r),ft(i,"loaded")?w(i,!0):p(i,u[1],u[2],null,t.__enabledOptions,t.__parents))},w=function(n,t){c(n.getElementsByTagName("ul")[0],t)},p=function(n,t,f,e,h,c){var v=hi(n),l=new r(i,function(t){ti(v);var r=document.createElement("ul"),i=n.getElementsByTagName("input");i=i.length?i[0].checked&&String.isNullOrEmpty(o(i[0],"disabled")):!1,String.isNullOrEmpty(e)||(r.className=e,r.setAttribute("id","tsc_treeId_"+f)),ut(n,"loaded"),t.forEach(function(n){var e=document.createElement("li"),v=document.createElement("div"),o=document.createElement("label"),t=document.createElement("input"),y=f+n.ContentType+n.ID,s=h[n.ID]||(h[n.ID]=b(n.ID,n.ContentType,n.Name)),l=n.ContentType+"|"+n.ID,u;e.className="tsc_"+n.ContentType,o.setAttribute("unselectable","on"),o.setAttribute("for",y),t.setAttribute("type","checkbox"),t.setAttribute("name","tsc_tree_"+f),nt[l]=c,t.setAttribute("value",l),t.setAttribute("id",y),i?(a(t,2),v.className="tsc_checkstate2"):(a(t,k(s)),v.className="tsc_checkstate"+k(s)),ii(o,rt),(n.ContentType==="Folder"||n.ContentType==="Mixed")&&(u=document.createElement("a"),u.__enabledOptions=s.Children||(s.Children={}),u.__parents=l,u.setAttribute("href","#expand|"+n.ID+"|"+f),ii(u,et),u.appendChild(document.createTextNode("+")),e.appendChild(u),e.appendChild(document.createTextNode(" "))),o.appendChild(document.createTextNode(n.Name)),e.appendChild(t),e.appendChild(v),e.appendChild(o),r.appendChild(e)}),n.appendChild(r)},function(n){u(String.format("Failed to retrieve tree branch. {0}",n),"error")});l.execute("GetChildren",t,s,f)};p(n,"0",t,"tsc_tree",f.Children,"0"),this.getSelected=function(){return ht(f)}},di=function(n,t,i,r,u){i=i||320,r=r||18;for(var h=0,e=0,l=n.getElementsByTagName("dl"),o=[],s,c,a=r+(u?"%":"px"),f=0;f<l.length;++f)s=l[f],s.parentNode==n&&ft(s,"tsc_panel")&&(s.setAttribute("id","tsc_pane"+e),o[e]=s,++e);for(t>e&&(t=e),f=0;f<e;++f)o[o.length]=document.getElementById("tsc_pane"+f);this.draw=function(){var w=er(n).w,k=w,d=t,l,s,y,b,v,g,p;if(c!=w){if(c=w,u||(w-=r),w>i)for(f=t-1;f>=0;--f){if(k=w/(f+1),k<i)continue;d=f+1;break}else d=1;if(k=u?(100-r)/d-r+"%":(k-r|0)+"px",y=[],b=[],h>0){for(f=0;f<e;++f)o[f].parentNode.removeChild(o[f]);for(f=0;f<h;++f)l=document.getElementById("column-"+f),l.parentNode.removeChild(l)}for(h=d,f=0;f<h;++f)v=document.createElement("div"),v.id="column-"+f,ut(v,"tsc_multi_column"),v.style.width=k,v.style.marginLeft=a,n.appendChild(v),s=y.length,y[s]=v,b[s]=v.offsetHeight;for(f=0;f<e;++f){if(l=o[f],f<y.length)s=f;else for(g=0,p=0;p<b.length;p++)(p==0||b[p]<g)&&(g=b[p],s=p);y[s]&&(l.parentNode&&l.parentNode.removeChild(l),y[s].appendChild(l),b[s]=y[s].offsetHeight)}}}},y=function(n,t){ir(),wi().innerHTML=kt(n)(t||{})},kt=function sr(n,t){var i=/\W/.test(n)?new Function("obj","var p=[]; with(obj){p.push('"+n.replace(/[\r\t\n]/g," ").replace(/'(?=[^{]*}})/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/{{=(.+?)}}/g,"',$1,'").split("{{").join("');").split("}}").join("p.push('")+"');}return p.join('');"):ei[n]=ei[n]||sr(document.getElementById(n).innerHTML);return t?i(t):i},hr=function(){if(n.XMLHttpRequest)return new n.XMLHttpRequest;if(window.ActiveXObject)try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}return!1},cr="0123456789ABCDEF",or=function(){for(var n=[],t=0;t<36;t++)n[t]=Math.floor(Math.random()*16);for(n[14]=4,n[19]=n[19]&3|8,t=0;t<36;t++)n[t]=cr[n[t]];return n[8]=n[13]=n[18]=n[23]="-",n.join("")},ur=function(n,t){if(typeof t=="string"){var i=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)(?:([\+-])(\d{2})\:(\d{2}))?Z?$/.exec(t);if(i)return new Date(Date.UTC(+i[1],+i[2]-1,+i[3],+i[4],+i[5],+i[6]))}return t},e=function(n,t){var r,i;for(t=t||0,r=[],i=t;i<n.length;i++)r.push(n[i]);return r},u=function(n,t){document.getElementById("tsc_messages").innerHTML="<div class='message "+(t||"info")+"'>"+n+"</div>"},wt=function(n,t){var i="";t.forEach(function(n){i+="<li>"+n+"</li>"}),document.getElementById("tsc_messages").innerHTML="<div class='message validation'><h4>"+n+"</h4><ul>"+i+"</ul></div>"},et=function(){document.getElementById("tsc_messages").innerHTML=""},tt=0,h=function(n){if(tt==0){var t=document.getElementById("tsc_working");t.innerHTML="<strong>"+(n||"Please Wait...")+"</strong>",c(t,!0)}++tt},a=function(){--tt,tt==0&&c(document.getElementById("tsc_working"),!1)},r=function(n,t,i,r){n=n+(n.indexOf("?")===-1?"?":"&")+"format=json";var u,s,o,c=0,a=function(n){!t||t(n)},f=function(n){!i||i(n)},l=function(){!r||r()},h=function(t){u=hr(),o=or(),s=!0,u.onreadystatechange=function(){var i,n,r;if(u.readyState===4&&s){s=!1;try{i=u.status}catch(e){i=200}if(i>=200&&i<=300){if(n=u.responseText,r=!0,n.indexOf("{")===0){try{n=JSON.parse(n,ur)}catch(e){r=!1,f("Exception "+e+". Data: "+n)}r&&(n.Error?f(n.Error):n.Id===o?a(n.Body):f(String.format("Invalid response. Sent ID doen't matches received ID. Data: {0}",n)))}}else{if(++c<3){delete u.onreadystatechange,u.onreadystatechange=null,h(t);return}f(u.statusText+":"+u.responseText)}delete u.onreadystatechange,u.onreadystatechange=null,l()}},u.open("POST",n+"&id="+o,!0),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),u.setRequestHeader("Content-length",t.length),u.overrideMimeType&&(u.setRequestHeader("Connection","close"),u.overrideMimeType("application/json")),u.send(t)};this.execute=function(n){h(JSON.stringify({Method:n,Arguments:e(arguments,1)}))}},dt=function(n){var t=[];return Array.isArray(n)||(n=[n]),n.forEach(function(n){n.args||(n.args=[]),n.validator.apply(null,n.args)||t.push(n.message)}),t},st=function(n){return n.length>0},pi=function(n,t){return n.length>=t},vi=function(n,t){return t.indexOf(n)===-1},li=function(n){return/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/i.test(n)},f=[],nt=[],it=[],rt,ai=function(n){var t;return f.forEach(function(i){i.ID===n&&(t=i)}),t},v=function(){y("main_tpl",{packages:f,quotes:nt,projects:it})},p;efx.showScreen=function(n){p&&clearTimeout(p),p=null,efx[n].apply(null,e(arguments,1))},efx.doConfirm=function(n,t){return window.confirm(n.split("\\n").join("\n"))&&t.apply(null,e(arguments,2)),!1},efx.listQuotesScreen=function(){new r(i,function(n){et(),f=[],nt=[],it=[],n.forEach(function(n){var t=n.Status;n.HumanStatus=t.replace(/([A-Z])/g," $1"),t=="QuoteOpen"?f.push(n):t.indexOf("Project")===-1?nt.push(n):it.push(n)}),v()},function(n){u(String.format("Failed to retrieve remote data. {0}",n),"error")},function(){p=setTimeout(function(){efx.showScreen("listQuotesScreen")},2e4)}).execute("ListQuotes"),v();var n=document.getElementById("tsc_status"),t=function(){c(n,!1),n.innerHTML=""};new r(i,function(i){i&&i.length?(c(n,!0),n.innerHTML=kt("status_tpl")({statuses:i})):t()},t).execute("GetStatuses")},efx.deletePackage=function(n){new r(i,null,function(n){u(String.format("Failed to delete package. {0}",n),"error")}).execute("DeleteQuote",n,t.UserName),f.forEach(function(t,i,r){t.ID===n&&r.splice(i,1)}),v()},efx.createQuoteScreen=function(n){y("createQuote_tpl",{sourceLanguages:t.SourceLanguages,targetLanguages:t.TargetLanguages,quickQuote:n})},efx.showConfigurationScreen=function(n){y("config_tpl",{fromConfig:n,configuration:t})},efx.saveConfiguration=function(){et();var f=s(document.getElementById("tsc_tokenID")),n=s(document.getElementById("tsc_Endpoint")),o=new r(i,function(){t.AuthorizationToken=f,t.TscServerEndPoint=n,ct=!1,efx.init()},function(n){u(String.format("Can not save configuration data. {0}",n),"error")},function(){a()}),e=dt([{validator:st,args:[f],message:"The Authorization Token is required."},{validator:st,args:[n],message:"The EndPoint URL is required."},{validator:li,args:[n],message:"The EndPoint URL is not in a valid form."},]);if(e.length>0){wt("There were some errors while checking the form:",e);return}h(),o.execute("SaveConfiguration",f,n)},efx.createQuote=function(n){et();var v=new r(i,function(t){f.push(t),efx.addDocuments(t.ID,n)},function(n){u(String.format("Failed to create quote. {0}",n),"error")},function(){a()}),l=s(document.getElementById("tsc_Name")),c=s(document.getElementById("tsc_SourceLang")),e=s(document.getElementById("tsc_TargetLangs"),!0),o=dt([{validator:st,args:[l],message:n?"The name of the quote is required.":"The name of the package is required."},{validator:pi,args:[e,1],message:"You have to select at least one target language"},{validator:vi,args:[c,e],message:"You can not select as target language the selected source language"},]);if(o.length>0){wt("There were some errors while checking the form:",o);return}h(),v.execute("CreateQuote",l,s(document.getElementById("tsc_Notes")),c,e,t.UserName)},efx.requestAQuote=function(n,e){new r(i,function(){f.forEach(function(t,i,r){t.ID===n&&(t.HumanStatus="Quote In Progress",t.Status="QuoteInProgress",t.Name=String.format("Creating quote for: {0}",t.Name),nt.push(t),r.splice(i,1))}),e?efx.listQuotesScreen():v()},function(n){u(String.format("Failed to request a quote. {0}",n),"error")}).execute("SendQuoteToGpms",n,t.UserName,e||!1)},efx.addDocuments=function(n,f){h(),new r(i,function(i){var s,h,e,o;i=i||{},rt={},s=ai(n),h=s.SourceLanguageISOCode,y("add_documents_tpl",{quote:s,quickQuote:f});for(var l=t.DocumentBrowserPanes,c=document.getElementById("tsc_columns"),u={},r=i.length-1;r>=0;--r)e=i[r],u[e.ID]=oi(e);l.forEach(function(n){var i=document.createElement("dl"),f=document.createElement("dt"),r=document.createElement("dd"),t=n.ID;i.className="tsc_panel",f.appendChild(document.createTextNode(n.Name)),i.appendChild(f),i.appendChild(r),c.appendChild(i),rt[t]=t.indexOf("options_")==0?new bi(r,t,u[t],h):new ki(r,t,u[t],h)}),o=new di(c,100,320,.833333,!0),o.draw(),gi(o.draw)},function(n){u(String.format("Failed to retrieve selected package items. {0}",n),"error")},function(){a()}).execute("ListPackageFiles",n)},efx.addSelectedDocuments=function(n,f){h();var e=[];Object.keys(rt).forEach(function(n){var t=rt[n].getSelected();t&&e.push(t)}),new r(i,function(){f?efx.requestAQuote(n,!0):efx.listQuotesScreen()},function(n){u(String.format("Failed to export selected documents. {0}",n),"error")},function(){a()}).execute("ModifyPackageFiles",n,t.UserName,e)},efx.importProject=function(n){h(),new r(i,function(){efx.listQuotesScreen()},function(n){u(String.format("Failed to import translations. {0}",n),"error")},function(){a()}).execute("Import",n,t.UserName)},efx.closeProject=function(n){new r(i,function(){it.forEach(function(t,i,r){t.ID===n&&r.splice(i,1)}),v()},function(n){u(String.format("Failed to close project. {0}",n),"error")}).execute("CloseQuote",n,t.UserName)},efx.addLangResource=function(n){bt=n},efx.init=function(){gt=!0,vt()},g=[],ot=function(){new r(i,function(n){t=n,ni=!0,vt()},function(n){u(String.format("Failed to retrieve configuration. {0}",n),"error")}).execute("GetConfiguration"),navigator&&(yt=!0),vt()},(typeof Array.isArray=="undefined"||typeof Array.prototype.forEach=="undefined"||typeof Object.keys=="undefined"||typeof Date.prototype.toISOString=="undefined"||typeof Date.prototype.toJSON=="undefined"||typeof String.prototype.trim=="undefined")&&g.push('/<%=WebResource("TSC.WebClient.js.EcmaScript5.min.js")%>'),g.length?n.include(g,ot):ot()}(window);